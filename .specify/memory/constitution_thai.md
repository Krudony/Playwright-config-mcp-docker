<!-- รายงานผลกระทบการซิงค์:
การเปลี่ยนแปลงเวอร์ชัน: 1.0.0
หลักการที่แก้ไข: สร้างหลักการทั้ง 5 ข้อใหม่
ส่วนที่เพิ่ม: มาตรฐานสถาปัตยกรรม, มาตรฐานคุณภาพโค้ด
ส่วนที่ลบ: ไม่มี
เทมเพลตที่ต้องอัปเดต: ⚠ .specify/templates/plan-template.md (ส่วนตรวจสอบรัฐธรรมนูญ), .specify/templates/tasks-template.md (การจัดประเภทงาน)
ตามมาดำเนินการ TODOs: ไม่มี
-->
# รัฐธรรมนูญสถาปัตยกรรม React + Rust ที่สะอาดและเป็นระเบียบ

## หลักการพื้นฐาน

### ข้อที่ 1. การแยกสถาปัตยกรรมที่สะอาด
Frontend (React) และ Backend (Rust) ต้องเป็นการแยกการใช้งานแบบสมบูรณ์ สื่อสารผ่าน REST/GraphQL APIs เท่านั้น ไม่มีสถานะที่แชร์กันหรือการเข้าถึงฐานข้อมูลโดยตรงจาก frontend ขอบเขตสัญญาที่ชัดเจนผ่านข้อกำหนด API

### ข้อที่ 2. ความปลอดภัยและประสิทธิภาพของ Rust เป็นหลัก
โค้ด Rust ทั้งหมดต้องใช้คุณสมบัติความปลอดภัยของ Rust (ownership, borrowing, lifetimes) ชอบการประกอบมากกว่าการสืบทอด ใช้ Result<T, E> สำหรับการจัดการข้อผิดพลาด หลักการ zero-cost abstractions ไม่อนุญาต unsafe blocks โดยไม่มีการอธิบายความปลอดภัย

### ข้อที่ 3. ความสะอาดของคอมโพเนนต์ React
คอมโพเนนต์ React ต้องเป็นความรับผิดชอบเดี่ยวและนำกลับมาใช้ใหม่ได้ custom hooks สำหรับตรรกะที่แชร์กัน คอมโพเนนต์ฟังก์ชันกับ hooks เท่านั้น อินเตอร์เฟซ Props ต้องถูกกำหนดด้วย TypeScript ไม่มีการเรียก API โดยตรงในคอมโพเนนต์ - ใช้ service layer

### ข้อที่ 4. การพัฒนาโดยยึดการทดสอบเป็นหลัก (บังคับ)
TDD บังคับ: เขียนการทดสอบ → ผู้ใช้อนุมัติ → การทดสอบล้มเหลว → จากนั้นจึง implement การทดสอบการทำงานร่วมกันสำหรับสัญญา API การทดสอบคอมโพเนนต์สำหรับ React การทดสอบพื้นฐานสำหรับตรรกะธุรกิจของ Rust ต้องมีการครอบคลุมโค้ดอย่างน้อย 80%

### ข้อที่ 5. เสถียรภาพของสัญญา API
สัญญาระหว่าง Rust backend และ React frontend ต้องมีการกำหนดเวอร์ชัน การเปลี่ยนแปลงที่ทำให้เสียหายต้องมีเวอร์ชัน API ใหม่ รักษาความเข้ากันได้แบบย้อนหลังอย่างน้อยหนึ่งเวอร์ชัน ต้องมีเอกสาร OpenAPI/Swagger สำหรับ endpoints ทั้งหมด

## มาตรฐานสถาปัตยกรรม

### โครงสร้างโปรเจค
```
frontend/          # แอปพลิเคชัน React TypeScript
├── src/
│   ├── components/    # คอมโพเนนต์ UI ที่นำกลับมาใช้ใหม่ได้
│   ├── pages/        # คอมโพเนนต์ระดับเส้นทาง
│   ├── hooks/        # React hooks ที่กำหนดเอง
│   ├── services/     # เลเยอร์ไคลเอนต์ API
│   ├── types/        # คำนิยามประเภท TypeScript
│   └── utils/        # ฟังก์ชันยูทิลิตี้บริสุทธิ์
├── tests/            # การทดสอบคอมโพเนนต์และการทำงานร่วมกัน
└── package.json

backend/           # แอปพลิเคชัน Rust
├── src/
│   ├── handlers/     # ตัวจัดการคำร้อง HTTP
│   ├── services/     # เลเยอร์ตรรกะธุรกิจ
│   ├── models/       # โครงสร้างข้อมูลและโมเดลโดเมน
│   ├── repositories/ # เลเยอร์การเข้าถึงข้อมูล
│   └── middleware/   # middleware HTTP
├── tests/            # การทดสอบหน่วยและการทำงานร่วมกัน
├── migrations/       # การย้ายฐานข้อมูล
└── Cargo.toml
```

### โปรโตคอลการสื่อสาร
- React → Rust: คำร้อง HTTP/HTTPS REST หรือ GraphQL
- การยืนยันตัวตน: JWT tokens พร้อมกลไกการรีเฟรช
- รูปแบบข้อมูล: JSON สำหรับคำร้อง/การตอบกลับ
- การจัดการข้อผิดพลาด: การตอบกลับข้อผิดพลาดที่มีโครงสร้างพร้อมรหัสข้อผิดพลาด
- เอกสาร: ข้อกำหนด OpenAPI ที่สร้างขึ้นโดยอัตโนมัติ

## มาตรฐานคุณภาพโค้ด

### ข้อกำหนด Rust
- ใช้ `rustfmt` สำหรับการจัดรูปแบบที่สม่ำเสมอ
- ใช้ `clippy` พร้อมกฎที่เข้มงวดเปิดใช้งาน
- ฟังก์ชันสาธารณะทั้งหมดต้องมีความคิดเห็นเอกสาร
- การจัดการข้อผิดพลาดด้วย `thiserror` หรือประเภทข้อผิดพลาดที่กำหนดเอง
- การบันทึกด้วย structured logging (tracing/serde)
- การกำหนดค่าผ่านตัวแปรสภาพแวดล้อม

### ข้อกำหนด React
- เปิดใช้งานโหมดเข้มงวด TypeScript
- ESLint + Prettier สำหรับการจัดรูปแบบโค้ด
- คอมโพเนนต์ทั้งหมดต้องมี PropTypes/อินเตอร์เฟซ TypeScript
- การปฏิบัติตามมาตรฐานการเข้าถึง (WCAG 2.1 AA ขั้นต่ำ)
- การตรวจสอบประสิทธิภาพด้วย React DevTools Profiler
- การจัดการสถานะด้วย Context API หรือไลบรารีภายนอก (Redux Toolkit/Zustand)

### มาตรฐานฐานข้อมูล
- การย้ายข้อมูลทั้งหมดต้องสามารถย้อนกลับได้
- บังคับใช้ข้อจำกัดคีย์นอก
- กำหนดค่าการเชื่อมต่อ pool อย่างเหมาะสม
- การปรับแก้ปัญหาการสืบค้นสำหรับปัญหา N+1
- บันทึกขั้นตอนการสำรองและคืนค่าข้อมูลเป็นประจำ

## การทำงานการพัฒนา

### เกตคุณภาพ
- โค้ดทั้งหมดต้องผ่านการทดสอบอัตโนมัติก่อนการผสาน
- ไม่อนุญาตช่องโหว่ด้านความปลอดภัย
- ต้องเคารพงบประมาณประสิทธิภาพ (<200ms การตอบกลับ API, <3s FCP)
- ต้องมีการตรวจสอบโค้ดสำหรับการเปลี่ยนแปลงทั้งหมด
- การอัปเดตเอกสารต้องเป็นไปพร้อมกับการเปลี่ยนแปลงโค้ด

### กลยุทธ์สาขา
- สาขาหลักพร้อมใช้งานเสมอ
- สาขาคุณสมบัติจากสาขาหลัก
- ต้องมี pull request สำหรับการเปลี่ยนแปลงทั้งหมด
- ไปป์ไลน์ CI/CD อัตโนมัติพร้อมการตรวจสอบคุณภาพ
- การเผยแพร่เวอร์ชันตามความหมาย

### ข้อกำหนดการทดสอบ
- การทดสอบหน่วยสำหรับตรรกะธุรกิจทั้งหมด
- การทดสอบการทำงานร่วมกันสำหรับ endpoints API
- การทดสอบคอมโพเนนต์สำหรับคอมโพเนนต์ React
- การทดสอบแบบ end-to-end สำหรับเส้นทางผู้ใช้ที่สำคัญ
- การทดสอบประสิทธิภาพสำหรับ endpoints ทั้งหมด

## การกำกับดูแล

รัฐธรรมนูญนี้เหนือกว่าแนวทางการพัฒนาอื่นๆ ทั้งหมด การแก้ไขต้องการ:
1. ข้อเสนอที่มีเอกสารพร้อมเหตุผล
2. การตรวจสอบและอนุมัติของทีม
3. การเพิ่มเวอร์ชันตามกฎการกำหนดเวอร์ชันตามความหมาย
4. แผนการโยกย้ายสำหรับโค้ดที่มีอยู่
5. การอัปเดตเอกสารและเทมเพลต

pull request ทั้งหมดต้องตรวจสอบการปฏิบัติตามหลักการเหล่านี้ การเบี่ยงเบนใดๆ ต้องได้รับการอธิบายเหตุผลและได้รับการอนุมัติจากความเห็นพ้องของทีม ใช้รัฐธรรมนูญนี้เป็นพื้นฐานสำหรับการตัดสินใจทางสถาปัตยกรรมและการตรวจสอบโค้ดทั้งหมด

**เวอร์ชัน**: 1.0.0 | **รับรอง**: 2025-01-24 | **แก้ไขล่าสุด**: 2025-01-24